# pm2-vs-watt

## Scale=1

Key parameters:
1. metrics are disabled everywhere
2. 1 process/thread 
3. no logs

### Node.js Core

```
$ npm run bench

> pm2-vs-watt@1.0.0 bench
> autocannon -c 100 -d 40 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections

Running 40s test @ http://localhost:3000
100 connections


┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 2 ms │ 3 ms  │ 4 ms │ 2.02 ms │ 0.38 ms │ 21 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬────────┬────────┬──────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%    │ 97.5%  │ Avg      │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼────────┼────────┼──────────┼────────┼─────────┤
│ Req/Sec   │ 38,751  │ 38,751  │ 40,799 │ 41,311 │ 40,654.4 │ 581.22 │ 38,733  │
├───────────┼─────────┼─────────┼────────┼────────┼──────────┼────────┼─────────┤
│ Bytes/Sec │ 6.93 MB │ 6.93 MB │ 7.3 MB │ 7.4 MB │ 7.28 MB  │ 104 kB │ 6.93 MB │
└───────────┴─────────┴─────────┴────────┴────────┴──────────┴────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 40

1626k requests in 40.02s, 291 MB read
```

### PM2


```
$ npm run bench

> pm2-vs-watt@1.0.0 bench
> autocannon -c 100 -d 40 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections

Running 40s test @ http://localhost:3000
100 connections


┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 2 ms │ 3 ms  │ 3 ms │ 2.02 ms │ 0.32 ms │ 13 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev  │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼─────────┤
│ Req/Sec   │ 38,783  │ 38,783  │ 40,095  │ 40,447  │ 40,036  │ 304.48 │ 38,779  │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────┼─────────┤
│ Bytes/Sec │ 6.94 MB │ 6.94 MB │ 7.18 MB │ 7.24 MB │ 7.17 MB │ 55 kB  │ 6.94 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 40

1602k requests in 40.01s, 287 MB read
```

### Watt

```
$ npm run bench

> pm2-vs-watt@1.0.0 bench
> autocannon -c 100 -d 40 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections

Running 40s test @ http://localhost:3000
100 connections


┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 2 ms │ 3 ms  │ 4 ms │ 2.02 ms │ 0.36 ms │ 20 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬────────┬────────┬─────────┬─────────┬──────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%   │ Avg      │ Stdev   │ Min    │
├───────────┼────────┼────────┼─────────┼─────────┼──────────┼─────────┼────────┤
│ Req/Sec   │ 39,103 │ 39,103 │ 40,543  │ 40,927  │ 40,291.2 │ 530.8   │ 39,096 │
├───────────┼────────┼────────┼─────────┼─────────┼──────────┼─────────┼────────┤
│ Bytes/Sec │ 7 MB   │ 7 MB   │ 7.26 MB │ 7.32 MB │ 7.21 MB  │ 95.2 kB │ 7 MB   │
└───────────┴────────┴────────┴─────────┴─────────┴──────────┴─────────┴────────┘

Req/Bytes counts sampled once per second.
# of samples: 40

1612k requests in 40.02s, 288 MB read
```

## Scale=2

### Node Cluster

```
$ npm run bench-scale

> pm2-vs-watt@1.0.0 bench-scale
> autocannon -c 100 -d 40 -w 2 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections
2 workers

Running 40s test @ http://localhost:3000
100 connections
2 workers

┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 1 ms │ 3 ms  │ 3 ms │ 1.23 ms │ 0.58 ms │ 29 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev    │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Req/Sec   │ 46,847  │ 46,847  │ 56,863  │ 58,847  │ 56,296  │ 2,262.63 │ 46,833  │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Bytes/Sec │ 8.38 MB │ 8.38 MB │ 10.2 MB │ 10.5 MB │ 10.1 MB │ 405 kB   │ 8.38 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 80

2252k requests in 40.02s, 403 MB read
```

### PM2

```
$ npm run bench-scale

> pm2-vs-watt@1.0.0 bench-scale
> autocannon -c 100 -d 40 -w 2 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections
2 workers

Running 40s test @ http://localhost:3000
100 connections
2 workers

|
┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 1 ms │ 3 ms  │ 3 ms │ 1.34 ms │ 0.67 ms │ 22 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev    │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Req/Sec   │ 47,519  │ 47,519  │ 52,671  │ 56,127  │ 52,484  │ 2,232.43 │ 47,518  │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Bytes/Sec │ 8.51 MB │ 8.51 MB │ 9.43 MB │ 10.1 MB │ 9.39 MB │ 399 kB   │ 8.51 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 80

2099k requests in 40.02s, 376 MB read
```

### resuePort: true with two processes

```
$ npm run bench-scale

> pm2-vs-watt@1.0.0 bench-scale
> autocannon -c 100 -d 40 -w 2 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections
2 workers

Running 40s test @ http://localhost:3000
100 connections
2 workers

|
┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 0 ms │ 1 ms │ 2 ms  │ 2 ms │ 0.95 ms │ 0.54 ms │ 20 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬───────────┬──────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg       │ Stdev    │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼───────────┼──────────┼─────────┤
│ Req/Sec   │ 63,551  │ 63,551  │ 75,455  │ 78,847  │ 75,275.61 │ 2,688.75 │ 63,522  │
├───────────┼─────────┼─────────┼─────────┼─────────┼───────────┼──────────┼─────────┤
│ Bytes/Sec │ 11.4 MB │ 11.4 MB │ 13.5 MB │ 14.1 MB │ 13.5 MB   │ 483 kB   │ 11.4 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴───────────┴──────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 80

3011k requests in 40.02s, 539 MB read
```


### Watt

```
$ npm run bench-scale

> pm2-vs-watt@1.0.0 bench-scale
> autocannon -c 100 -d 40 -w 2 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections
2 workers

Running 40s test @ http://localhost:3000
100 connections
2 workers

|
┌─────────┬──────┬──────┬───────┬──────┬──────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg  │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼──────┼─────────┼───────┤
│ Latency │ 0 ms │ 1 ms │ 2 ms  │ 2 ms │ 1 ms │ 0.48 ms │ 23 ms │
└─────────┴──────┴──────┴───────┴──────┴──────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬──────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev    │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
│ Req/Sec   │ 63,455  │ 63,455  │ 75,839  │ 78,527  │ 75,082.8 │ 3,178.07 │ 63,433  │
├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
│ Bytes/Sec │ 11.4 MB │ 11.4 MB │ 13.6 MB │ 14.1 MB │ 13.4 MB  │ 568 kB   │ 11.4 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴──────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 80

3003k requests in 40.02s, 538 MB read
```

### PM2

```
$ npm run bench-scale

> pm2-vs-watt@1.0.0 bench-scale
> autocannon -c 100 -d 40 -w 2 -W [ -c 100 -d 10 ] http://localhost:3000

Running 10s warmup @ http://localhost:3000
100 connections
2 workers

Running 40s test @ http://localhost:3000
100 connections
2 workers

|
┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 1 ms │ 3 ms  │ 3 ms │ 1.34 ms │ 0.67 ms │ 22 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬──────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev    │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Req/Sec   │ 47,519  │ 47,519  │ 52,671  │ 56,127  │ 52,484  │ 2,232.43 │ 47,518  │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼──────────┼─────────┤
│ Bytes/Sec │ 8.51 MB │ 8.51 MB │ 9.43 MB │ 10.1 MB │ 9.39 MB │ 399 kB   │ 8.51 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴──────────┴─────────┘

Req/Bytes counts sampled once per second.
# of samples: 80

2099k requests in 40.02s, 376 MB read
```

## Licenses

PM2 is licensed as AGPL, therefore you are forced to get a license from Keymetrics to use it, as some of its parts are loaded into your applications.
Watt is licensed as Apache 2.0.
